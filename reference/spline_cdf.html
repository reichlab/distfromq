<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Approximate density function, cdf, or quantile function on the interior of provided quantiles by representing the distribution as a sum of a discrete part at any duplicated qs and a continuous part for which the cdf is estimated using a monotonic Hermite spline. See details for more. — spline_cdf • distfromq</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Approximate density function, cdf, or quantile function on the interior of provided quantiles by representing the distribution as a sum of a discrete part at any duplicated qs and a continuous part for which the cdf is estimated using a monotonic Hermite spline. See details for more. — spline_cdf"><meta name="description" content="Approximate density function, cdf, or quantile function on the interior of
provided quantiles by representing the distribution as a sum of a discrete
part at any duplicated qs and a continuous part for which the cdf is
estimated using a monotonic Hermite spline. See details for more.
Internal function that constructs a monotonic Hermite spline interpolating
ps and qs."><meta property="og:description" content="Approximate density function, cdf, or quantile function on the interior of
provided quantiles by representing the distribution as a sum of a discrete
part at any duplicated qs and a continuous part for which the cdf is
estimated using a monotonic Hermite spline. See details for more.
Internal function that constructs a monotonic Hermite spline interpolating
ps and qs."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">distfromq</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/distfromq.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Approximate density function, cdf, or quantile function on the interior of provided quantiles by representing the distribution as a sum of a discrete part at any duplicated <code>qs</code> and a continuous part for which the cdf is estimated using a monotonic Hermite spline. See details for more.</h1>

      <div class="d-none name"><code>spline_cdf.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Approximate density function, cdf, or quantile function on the interior of
provided quantiles by representing the distribution as a sum of a discrete
part at any duplicated <code>qs</code> and a continuous part for which the cdf is
estimated using a monotonic Hermite spline. See details for more.</p>
<p>Internal function that constructs a monotonic Hermite spline interpolating
ps and qs.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spline_cdf</span><span class="op">(</span><span class="va">ps</span>, <span class="va">qs</span>, <span class="va">tail_dist</span>, fn_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"p"</span>, <span class="st">"q"</span><span class="op">)</span>, n_grid <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">spline_cdf_grid_interp</span><span class="op">(</span></span>
<span>  <span class="va">ps</span>,</span>
<span>  <span class="va">qs</span>,</span>
<span>  <span class="va">tail_dist</span>,</span>
<span>  fn_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"p"</span>, <span class="st">"q"</span><span class="op">)</span>,</span>
<span>  n_grid <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">spline_cdf_direct</span><span class="op">(</span><span class="va">ps</span>, <span class="va">qs</span>, <span class="va">tail_dist</span>, fn_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"p"</span>, <span class="st">"q"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ps">ps<a class="anchor" aria-label="anchor" href="#arg-ps"></a></dt>
<dd><p>vector of probability levels</p></dd>


<dt id="arg-qs">qs<a class="anchor" aria-label="anchor" href="#arg-qs"></a></dt>
<dd><p>vector of quantile values correponding to ps</p></dd>


<dt id="arg-tail-dist">tail_dist<a class="anchor" aria-label="anchor" href="#arg-tail-dist"></a></dt>
<dd><p>name of parametric distribution for the tails</p></dd>


<dt id="arg-fn-type">fn_type<a class="anchor" aria-label="anchor" href="#arg-fn-type"></a></dt>
<dd><p>the type of function that is requested: <code>"d"</code> for a pdf,
<code>"p"</code> for a cdf, or <code>"q"</code> for a quantile function.</p></dd>


<dt id="arg-n-grid">n_grid<a class="anchor" aria-label="anchor" href="#arg-n-grid"></a></dt>
<dd><p>grid size to use when augmenting the input <code>qs</code> to obtain a
finer grid of points along which we form a piecewise linear approximation
to the spline. <code>n_grid</code> evenly-spaced points are inserted between each
pair of consecutive values in <code>qs</code>. The default value is 20. This can
be set to <code>NULL</code>, in which case the piecewise linear approximation is not
used. This is not recommended if the <code>fn_type</code> is <code>"q"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a function to evaluate the pdf, cdf, or quantile function.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The cdf of the continuous part of the distribution is estimated
using a monotonic degree 3 Hermite spline that interpolates the quantiles
after subtracting the discrete distribution and renormalizing. In theory,
an estimate of the quantile function could be obtained by directly inverting
this spline. However, in practice, we have observed that this can suffer from
numerical problems. Therefore, the default behavior of this function is to
evaluate the "stage 1" cdf estimate corresponding to discrete point masses
plus monotonic spline at a fine grid of points, and use the "stage 2" cdf
estimate that linearly interpolates these points with steps at any duplicated
q values. The quantile function estimate is obtained by inverting this
"stage 2" cdf estimate. When the distribution is continuous, we can obtain an
estimate of the pdf by differentiating the cdf estimate, resulting in a
discontinuous "histogram density". The size of the grid can be specified with
the <code>n_grid</code> argument. In settings where it is desirable to obtain a
continuous density function, the "stage 1" cdf estimate can be used by
setting <code>n_grid = NULL</code>.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Evan Ray, Aaron Gerding.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

